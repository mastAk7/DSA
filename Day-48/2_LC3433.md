```cpp
class Solution {
public:
    vector<int> countMentions(int n, vector<vector<string>>& events) {
        vector<int> off(n,0), count(n,0);
        sort(events.begin(),events.end(),
            [](const vector<string> &a, const vector<string> &b){
                int i = stoi(a[1]), j = stoi(b[1]);
                if(i!=j) return i<j;
                if(a[0]=="OFFLINE") return true;
                return false;
            });
        for(auto &event:events){
            int t = stoi(event[1]);
            if(event[0]=="MESSAGE"){
                if(event[2]=="ALL") for(int i=0; i<n; i++) count[i]++;
                else if(event[2]=="HERE") for(int i=0; i<n; i++) {if(off[i]<=t) count[i]++;}
                else{
                    stringstream ss(event[2]);
                    string word;
                    while(ss>>word){
                        word = word.substr(2);
                        int id = stoi(word);
                        count[id]++;
                    }
                }
            } else off[stoi(event[2])] = t + 60;
        }
        return count;
    }
};
```