```cpp
typedef vector<int> vi;
typedef vector<vi> vii;
class Solution {
public:
    int countCoveredBuildings(int n, vector<vector<int>>& buildings) {
        vi wmax(n+1,0), wmin(n+1,n+1);
        vi hmax(n+1,0), hmin(n+1,n+1);
        for(auto &x:buildings){
            wmax[x[0]] = max(wmax[x[0]],x[1]);
            wmin[x[0]] = min(wmin[x[0]],x[1]);
            hmax[x[1]] = max(hmax[x[1]],x[0]);
            hmin[x[1]] = min(hmin[x[1]],x[0]);
        }
        int c=0;
        for(auto &x:buildings) if((wmax[x[0]]>x[1]) && (wmin[x[0]]<x[1]) && (hmax[x[1]]>x[0]) && (hmin[x[1]]<x[0])) c++;
        return c;
    }
};
```